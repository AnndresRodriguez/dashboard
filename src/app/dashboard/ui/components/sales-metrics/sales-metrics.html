<section class="main-container-metrics w-full" data-test-id="sales-metrics-container">
  @if (store.loading())
  {
    <div class="flex flex-row justify-between w-full" data-test-id="loading-skeleton-container">
      @for (loader of skeletonsMetrics; track loader) {
        <ngx-skeleton-loader
          [theme]="{
            height: '9.5rem',
            width: '18rem',
            borderRadius: '8px',
          }"
          [count]="1"
          data-test-id="metric-skeleton-loader"
        ></ngx-skeleton-loader>
      }
    </div>
  }

  @else if (store.hasError())
  {
    <div class="flex justify-center items-center p-8" data-test-id="error-container">
      <div class="text-red-600 text-center">
        <p class="font-semibold" data-test-id="error-title">Error al cargar datos</p>
        <p class="text-sm mt-1" data-test-id="error-message"> No hemos podido obtener la información en este momento, por favor intentalo de nuevo</p>
        <button
          (click)="store.loadSalesMetrics()"
          class="mt-2 px-4 py-2 bg-blue text-white rounded font-normal text-sm hover:bg-blue-700"
          data-test-id="retry-button"
        >
          Reintentar
        </button>
      </div>
    </div>
  }

  @else if (store.isEmpty())
  {
    <div class="flex justify-center items-center p-8" data-test-id="empty-state-container">
      <p class="text-gray-500" data-test-id="empty-state-message">No hay métricas disponibles</p>
    </div>
  }

  @else {
    @for (metric of store.salesMetrics(); track metric.getTitle()) {
      <app-card-metric
        class="flex-grow"
        [title]="metric.getTitle()"
        [value]="metric.getValue()"
        [currency]="metric.getCurrency()"
        [percentageChange]="metric.getPercentageChange()"
        [changeType]="metric.getChangeType()"
        [description]="metric.getDescription()"
        data-test-id="metric-card"
      ></app-card-metric>
    }
  }
</section>
